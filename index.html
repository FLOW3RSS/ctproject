<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ë¹„ë²„ì˜ ì´ì¤‘ì•”í˜¸ ê·œì¹™</title>
  <style>
    body { font-family: 'Arial'; padding: 20px; line-height: 1.6; }
    h1, h2 { color: #003366; }
    .problem-box { border: 2px solid #ccc; padding: 15px; margin-top: 15px; background-color: #f9f9f9; }
    .timer { font-size: 18px; font-weight: bold; color: red; }
    .popup { display: none; position: fixed; top: 30%; left: 50%; transform: translate(-50%, -50%); background: white; border: 2px solid #888; padding: 30px; z-index: 999; text-align: center; }
    .popup button, #retryBtn { padding: 10px 20px; margin-top: 10px; display: none; }
    .choices { margin-top: 15px; }
    .choices label { display: block; margin-bottom: 5px; }
    #resultMessage { margin-top: 15px; font-weight: bold; color: green; }
  </style>
</head>
<body>
  <h1>1. íƒ€ì´í‹€: ë¹„ë²„ì˜ ì´ì¤‘ì•”í˜¸ ê·œì¹™</h1>
  <h2>2. ëŒ€ìƒ ë° êµê³¼: ê³ 1 ê³µí†µìˆ˜í•™2(í•¨ìˆ˜)</h2>

  <h3>3. ì§€ë¬¸:</h3>
  <p>ë¹„ë²„ëŠ” ì¹œêµ¬ì—ê²Œ ë¹„ë°€ ë©”ì‹œì§€ë¥¼ ë³´ë‚¼ ë•Œ íŠ¹ë³„í•œ ì•”í˜¸ ê·œì¹™ì„ ì‚¬ìš©í•©ë‹ˆë‹¤. ë¹„ë²„ê°€ ì‚¬ìš©í•˜ëŠ” ë¬¸ìì—ëŠ” A, B, C, D, E ë‹¤ì„¯ ê¸€ìë§Œ ìˆìŠµë‹ˆë‹¤.<br>
  ë¹„ë²„ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ë§í•©ë‹ˆë‹¤:<br>
  "ë‚˜ëŠ” í•œ ë²ˆ ë³€í™˜í•  ë•Œ ë‘ ë‹¨ê³„ë¡œ ë‚˜ëˆ ì„œ ê¸€ìë¥¼ ë°”ê¿”. ë¨¼ì €, ëª¨ë“  ê¸€ìë¥¼ ê°™ì€ ë°©ì‹ìœ¼ë¡œ ë°”ê¾¸ê³ , ê·¸ë‹¤ìŒì—ëŠ” í™€ìˆ˜ ë²ˆì§¸ ê¸€ìë§Œ ë‹¤ì‹œ í•œ ë²ˆ ë” ë°”ê¾¸ì§€!"<br>
  ë‹¤ìŒ ì˜ˆì‹œëŠ” ëª‡ ê°€ì§€ ì…ë ¥ â†’ ê²°ê³¼ ì˜ˆì‹œì…ë‹ˆë‹¤.</p>

  <h3>4. ê·œì¹™ ì˜ˆì‹œ:</h3>
  <ul>
    <li>ì˜ˆì‹œ1: ì…ë ¥: BADEC â†’ 1íšŒ ë³€í™˜: DBAAE</li>
    <li>ì˜ˆì‹œ2: ì…ë ¥: DBAAE â†’ 1íšŒ ë³€í™˜: ACCBB</li>
  </ul>

  <div class="problem-box">
    <h3>5. ë¬¸ì œ:</h3>
    <p>ë¹„ë²„ëŠ” ë¬¸ìë¥¼ ë°”ê¿€ ë•Œ, ìœ„ì¹˜(1ë²ˆ, 2ë²ˆ, 3ë²ˆ...)ê°€ í™€ìˆ˜ì¸ì§€ ì§ìˆ˜ì¸ì§€ì— ë”°ë¼ ë‹¤ë¥¸ ì²˜ë¦¬ë¥¼ í•œë‹¤ê³  í–ˆìŠµë‹ˆë‹¤.<br>
    ì˜ˆì‹œë“¤ì„ ë¶„ì„í•œ í›„, ë¹„ë²„ê°€ ë¬¸ì <span id="questionInput">BADEC</span>ì„ ìœ„ ê·œì¹™ì— ë”°ë¼ <strong><span id="repeatDisplay">5</span></strong>íšŒ ë°˜ë³µ ë³€í™˜í•˜ë©´ ìµœì¢… ê²°ê³¼ëŠ” ë¬´ì—‡ì¼ê¹Œìš”?</p>

    <label for="repeatCount">ğŸ” ë³€í™˜ íšŸìˆ˜:</label>
    <input type="number" id="repeatCount" value="5" min="1" max="20" style="width: 60px;" onchange="updateRepeatDisplay()">

    <div class="choices">
      <label><input type="radio" name="answer" value="A"> A. <span id="choiceA">---</span></label>
      <label><input type="radio" name="answer" value="B"> B. <span id="choiceB">---</span></label>
      <label><input type="radio" name="answer" value="C"> C. <span id="choiceC">---</span></label>
      <label><input type="radio" name="answer" value="D"> D. <span id="choiceD">---</span></label>
    </div>

    <label>â± ì‹œê°„ ì„¤ì •:
      <select id="timeSelect">
        <option value="30">30ì´ˆ</option>
        <option value="60">1ë¶„</option>
        <option value="90">1ë¶„ 30ì´ˆ</option>
        <option value="120">2ë¶„</option>
      </select>
    </label>
    <button onclick="startProblem()">ë¬¸ì œ í’€ê¸°</button>
    <button onclick="submitAnswer()">ì •ë‹µ ì œì¶œ</button>
    <button id="retryBtn" onclick="retry()">ë‹¤ì‹œ ë„ì „í•˜ê¸°</button>
    <div id="timer" class="timer"></div>
    <div id="resultMessage"></div>
  </div>

  <div class="popup" id="timeoutPopup">
    <p>â° ì‹œê°„ ì´ˆê³¼!</p>
    <button onclick="retry()">ë‹¤ì‹œ ë„ì „í•˜ê¸°</button>
  </div>

  <script>
    let timerInterval;
    let currentCorrectAnswer = "A";
    let timeLeft = 0;

    const charToNum = { A: 0, B: 1, C: 2, D: 3, E: 4 };
    const numToChar = ['A', 'B', 'C', 'D', 'E'];

    // âœ… ì •í™•í•œ ì•”í˜¸ ê·œì¹™: +1, í™€ìˆ˜ ìë¦¬ë§Œ ë‹¤ì‹œ +1 (ì´ +2)
    function correctTransform(word) {
      let nums = [...word].map(c => (charToNum[c] + 1) % 5); // Step 1: ì „ì²´ +1
      [0, 2, 4].forEach(i => nums[i] = (nums[i] + 1) % 5);     // Step 2: í™€ìˆ˜ ìë¦¬ë§Œ ì¶”ê°€ +1
      return nums.map(n => numToChar[n]).join('');
    }

    function repeatTransform(input, count) {
      let result = input;
      for (let i = 0; i < count; i++) {
        result = correctTransform(result);
      }
      return result;
    }

    function generateFakeChoices(correctOutput, input, count = 3) {
      const fakeChoices = new Set();
      while (fakeChoices.size < count) {
        const randRepeat = Math.floor(Math.random() * 10 + 1); // 1~10íšŒ ë°˜ë³µ
        const fake = repeatTransform(input, randRepeat);
        if (fake !== correctOutput && !fakeChoices.has(fake)) {
          fakeChoices.add(fake);
        }
      }
      return Array.from(fakeChoices);
    }

    function updateRepeatDisplay() {
      document.getElementById('repeatDisplay').textContent = document.getElementById('repeatCount').value;
      pickRandomProblem();
    }

    function pickRandomProblem() {
      const input = "BADEC";
      const repeatCount = parseInt(document.getElementById('repeatCount').value);
      const correctOutput = repeatTransform(input, repeatCount);

      const fakeChoices = generateFakeChoices(correctOutput, input);
      const correctIndex = Math.floor(Math.random() * 4);
      fakeChoices.splice(correctIndex, 0, correctOutput); // ì •ë‹µ ì‚½ì…

      const choiceSpans = ['choiceA', 'choiceB', 'choiceC', 'choiceD'];
      const answerLetters = ['A', 'B', 'C', 'D'];
      for (let i = 0; i < 4; i++) {
        document.getElementById(choiceSpans[i]).textContent = fakeChoices[i];
      }
      currentCorrectAnswer = answerLetters[correctIndex];

      document.getElementById('questionInput').textContent = input;
      document.querySelectorAll('input[name="answer"]').forEach(el => el.checked = false);
      document.getElementById('resultMessage').textContent = "";
      document.getElementById('retryBtn').style.display = 'none';
    }

    function startProblem() {
      const select = document.getElementById('timeSelect');
      timeLeft = parseInt(select.value);
      document.getElementById('timer').textContent = `ë‚¨ì€ ì‹œê°„: ${timeLeft}ì´ˆ`;
      clearInterval(timerInterval);
      document.getElementById('retryBtn').style.display = 'none';

      timerInterval = setInterval(() => {
        if (timeLeft > 0) {
          timeLeft--;
          document.getElementById('timer').textContent = `ë‚¨ì€ ì‹œê°„: ${timeLeft}ì´ˆ`;
        } else {
          clearInterval(timerInterval);
          document.getElementById('timeoutPopup').style.display = 'block';
        }
      }, 1000);
    }

    function retry() {
      document.getElementById('timeoutPopup').style.display = 'none';
      clearInterval(timerInterval);
      document.getElementById('timer').textContent = '';
      document.getElementById('resultMessage').textContent = '';
      pickRandomProblem();
    }

    function submitAnswer() {
      const selected = document.querySelector('input[name="answer"]:checked');
      const result = document.getElementById('resultMessage');
      if (!selected) {
        result.style.color = 'red';
        result.textContent = "âš  ì •ë‹µì„ ì„ íƒí•´ì£¼ì„¸ìš”.";
        return;
      }
      if (selected.value === currentCorrectAnswer) {
        result.style.color = 'green';
        result.textContent = "âœ… ì •ë‹µì…ë‹ˆë‹¤!";
        clearInterval(timerInterval);
        document.getElementById('retryBtn').style.display = 'inline-block';
      } else {
        result.style.color = 'red';
        result.textContent = "âŒ ì˜¤ë‹µì…ë‹ˆë‹¤.";
      }
    }

    // ì´ˆê¸° ì‹¤í–‰
    pickRandomProblem();
  </script>
</body>
</html>
